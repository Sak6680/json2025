<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>IMF GDP Per Capita Ranking</title>

<style>
    body {
        background: #0f0f0f;
        color: #fff;
        font-family: Arial;
        padding: 20px;
    }
    h1 {
        text-align: center;
        margin-bottom: 25px;
    }
    .row {
        display: flex;
        align-items: center;
        padding: 10px 5px;
        border-bottom: 1px solid #333;
        font-size: 18px;
    }
    .rank { width: 50px; }
    .flag {
        width: 45px;
        height: 30px;
        margin-right: 12px;
        border: 1px solid #444;
    }
    .name { width: 220px; }
    .value {
        font-weight: bold;
        transition: color 2s;
    }
</style>

</head>
<body>

<h1>IMF GDP Per Capita Ranking (NGDPDPC)</h1>
<div id="list"></div>

<script>
// ============================
//   190 COUNTRY NAMES (SAFE)
// ============================
const COUNTRY_NAMES = {
    "USA":"United States",
    "CHN":"China",
    "JPN":"Japan",
    "DEU":"Germany",
    "GBR":"United Kingdom",
    "FRA":"France",
    "IND":"India",
    "ITA":"Italy",
    "CAN":"Canada",
    "BRA":"Brazil",
    "KOR":"South Korea",
    "RUS":"Russia",
    "AUS":"Australia",
    "ESP":"Spain",
    "MEX":"Mexico",
    "IDN":"Indonesia",
    "TUR":"Turkey",
    "NLD":"Netherlands",
    "CHE":"Switzerland",
    "SAU":"Saudi Arabia",
    // You will receive FULL 190 LIST next message
};

// Converts ISO3 → ISO2 for flags
function iso3to2(code) {
    const map = {
        USA:"us", GBR:"gb", DEU:"de", FRA:"fr", ITA:"it",
        ESP:"es", CHE:"ch", CHN:"cn", JPN:"jp", IND:"in",
        KOR:"kr", RUS:"ru", BRA:"br", CAN:"ca", AUS:"au",
        MEX:"mx", NLD:"nl", TUR:"tr", IDN:"id", SAU:"sa",
        // full mapping will be added for all 190
    };
    return map[code] || code.substring(0,2).toLowerCase();
}

// Smooth number animation
function animate(id, start, end, duration) {
    const el = document.getElementById(id);
    let startTime = null;

    function step(ts) {
        if (!startTime) startTime = ts;
        const progress = Math.min((ts - startTime) / duration, 1);

        const val = Math.floor(start + (end - start) * progress);
        el.textContent = val.toLocaleString();

        // Green/red animation
        el.style.color = end >= start ? "lime" : "red";
        if (progress === 1) {
            setTimeout(() => el.style.color = "white", 2000);
        }

        if (progress < 1) requestAnimationFrame(step);
    }
    requestAnimationFrame(step);
}

// =====================================
//   MAIN FUNCTION — LOAD GDP PC
// =====================================
async function loadGDP() {
    const url = "https://www.imf.org/external/datamapper/api/v1/NGDPDPC";

    const res = await fetch(url);
    const data = await res.json();

    const gdp = data.values.NGDPDPC;
    const list = [];

    for (let code in gdp) {
        const years = Object.keys(gdp[code]).map(Number);
        const lastYear = Math.max(...years);
        const value = gdp[code][lastYear];

        if (!value) continue;

        list.push({
            code,
            value,
            year: lastYear,
            name: COUNTRY_NAMES[code] || code
        });
    }

    // Sort high → low
    list.sort((a, b) => b.value - a.value);

    const container = document.getElementById("list");
    let rank = 1;

    list.forEach(item => {
        const row = document.createElement("div");
        row.className = "row";
        const code2 = iso3to2(item.code);

        row.innerHTML = `
            <div class="rank">${rank}</div>
            <img class="flag" src="https://flagcdn.com/w40/${code2}.png">
            <div class="name">${item.name}</div>
            <div class="value" id="val_${rank}">0</div>
        `;

        container.appendChild(row);
        animate(`val_${rank}`, 0, item.value, 1500);

        rank++;
    });
}

loadGDP();
</script>

</body>
</html>
